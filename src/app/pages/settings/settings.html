<div class="settings-container">
  <!-- Header -->
  <div class="header">
    <h1 class="page-title">Account Settings</h1>
    <div class="user-greeting">
      <span class="user-name">{{ userName }}</span>
    </div>
  </div>

  <!-- Settings Cards Grid -->
  <div class="settings-grid">
    <!-- Profile Update Card -->
    <div class="settings-card">
      <div class="card-header">
        <h2 class="card-title">Profile Information</h2>
        <p class="card-subtitle">Update your name and email address</p>
      </div>

      <form [formGroup]="profileForm" (ngSubmit)="updateProfile()">
        <!-- Full Name -->
        <div class="form-group">
          <label for="fullName">Full Name</label>
          <input
            type="text"
            id="fullName"
            formControlName="fullName"
            placeholder="Enter your full name"
          />
          <div
            class="error"
            *ngIf="profileForm.get('fullName')?.touched && profileForm.get('fullName')?.invalid"
          >
            <span *ngIf="profileForm.get('fullName')?.errors?.['required']">
              Name is required
            </span>
            <span *ngIf="profileForm.get('fullName')?.errors?.['minlength']">
              Name must be at least 3 characters
            </span>
            <span *ngIf="profileForm.get('fullName')?.errors?.['maxlength']">
              Name must not exceed 100 characters
            </span>
          </div>
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email">Email Address</label>
          <input
            type="email"
            id="email"
            formControlName="email"
            placeholder="Enter your email"
          />
          <div
            class="error"
            *ngIf="profileForm.get('email')?.touched && profileForm.get('email')?.invalid"
          >
            <span *ngIf="profileForm.get('email')?.errors?.['required']">
              Email is required
            </span>
            <span *ngIf="profileForm.get('email')?.errors?.['email']">
              Enter a valid email address
            </span>
          </div>
        </div>

        <!-- Submit Button -->
        <button
          type="submit"
          class="btn-submit"
          [disabled]="profileForm.invalid || profileLoading"
        >
          {{ profileLoading ? 'Updating...' : 'Update Profile' }}
        </button>
      </form>
    </div>

    <!-- Change Password Card -->
    <div class="settings-card">
      <div class="card-header">
        <h2 class="card-title">Change Password</h2>
        <p class="card-subtitle">Update your password to keep your account secure</p>
      </div>

      <form [formGroup]="passwordForm" (ngSubmit)="changePassword()">
        <!-- Old Password -->
        <div class="form-group">
          <label for="oldPassword">Current Password</label>
          <div class="password-group">
            <input
              [type]="showOldPassword ? 'text' : 'password'"
              id="oldPassword"
              formControlName="oldPassword"
              placeholder="Enter your current password"
            />
            <span class="eye material-icons" (click)="showOldPassword = !showOldPassword">
              {{ showOldPassword ? 'visibility_off' : 'visibility' }}
            </span>
          </div>
          <div
            class="error"
            *ngIf="
              passwordForm.get('oldPassword')?.touched &&
              passwordForm.get('oldPassword')?.invalid
            "
          >
            <span *ngIf="passwordForm.get('oldPassword')?.errors?.['required']">
              Current password is required
            </span>
          </div>
        </div>

        <!-- New Password -->
        <div class="form-group">
          <label for="newPassword">New Password</label>
          <div class="password-group">
            <input
              [type]="showNewPassword ? 'text' : 'password'"
              id="newPassword"
              formControlName="newPassword"
              placeholder="Enter your new password"
            />
            <span class="eye material-icons" (click)="showNewPassword = !showNewPassword">
              {{ showNewPassword ? 'visibility_off' : 'visibility' }}
            </span>
          </div>
          <div
            class="error"
            *ngIf="
              passwordForm.get('newPassword')?.touched &&
              passwordForm.get('newPassword')?.invalid
            "
          >
            <span *ngIf="passwordForm.get('newPassword')?.errors?.['required']">
              New password is required
            </span>
            <span *ngIf="passwordForm.get('newPassword')?.errors?.['minlength']">
              Password must be at least 6 characters
            </span>
          </div>
        </div>

        <!-- Submit Button -->
        <button
          type="submit"
          class="btn-submit"
          [disabled]="passwordForm.invalid || passwordLoading"
        >
          {{ passwordLoading ? 'Changing...' : 'Change Password' }}
        </button>
      </form>
    </div>
  </div>

  <!-- Account Info Card (Optional) -->
  <div class="info-card" *ngIf="userProfile">
    <div class="info-header">
      <h3>Account Information</h3>
    </div>
    <div class="info-grid">
      <div class="info-item">
        <span class="info-label">Role</span>
        <span class="info-value">{{ userProfile.role }}</span>
      </div>
      <div class="info-item">
        <span class="info-label">Member Since</span>
        <span class="info-value">{{ userProfile.createdAt | date: 'MMM dd, yyyy' }}</span>
      </div>
      <div class="info-item">
        <span class="info-label">Last Login</span>
        <span class="info-value">{{
          userProfile.lastLogin | date: 'MMM dd, yyyy HH:mm'
        }}</span>
      </div>
    </div>
  </div>
</div>